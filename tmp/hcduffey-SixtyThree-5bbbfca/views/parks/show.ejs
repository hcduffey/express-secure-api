<!DOCTYPE html>
<html lang="en">
<%- include( '../partials/head.ejs', { page: 'Park'}) %>
<body>

    <%- include('../partials/nav.ejs') %>

    <div class="container">
        <style>
            h1, h2 {
                text-align: center;
                margin: auto;}
            img {
                max-width: 1000px;
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;}
            .badge-image {
                max-width: 150px;
            }
        </style>

        <h1> <%= parks[id].name %> </h1>
        <h2>National Park</h2>
        <img src="<%= parks[id].imageUrl %>" alt="<%parks[id].name%> Image">
        <h3>ABOUT: <%= parks[id].description %></h3>
        

        <% if(currentUserId !== "") { %>

            <% if(beenToPark) { %>
                <p>You've been here!</p>
            <% } else { %>
                <form method="POST" action="/users/<%= currentUserId %>?_method=PUT">
                    <input value="<%= parks[id]._id %>" name="park" type="hidden">
                    <button type="submit">I've Been Here!</button>
                </form>
            <% } %>

        <% } %>

        <img class="badge-image" id="badge-show<%id%>" src="<%= badges[id].avatar %>" alt="<%=badges[id].name%> Badge" />

        <% if(currentUserId !== "" && beenToPark) { %>
            <form action="/ratings" method="POST">
                <legend>Rate this Park</legend>
                <fieldset>
                    <select name="rating" id="rating">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5" selected>5</option>
                    </select>
                    <textarea id="comment" name="comment" rows="5" cols="33"></textarea>
                    <input value="<%= parks[id]._id %>" name="park" type="hidden">
                
                    <button type="submit">Submit</button>
                </fieldset>
            </form>
        <% } %>
        
        <h3>REVIEWS</h3>
        <% for(let i=0; i < ratings.length; i++) { %>
            <p><%= ratings[i].comment %> <%= ratings[i].rating %></p>
            <p><%= ratings[i].user.name %></p>
            
            <% if(currentUserId == ratings[i].user._id) { %>

                <form method="POST" action="/ratings/<%= ratings[i]._id %>?_method=DELETE">
                    <input value="<%= parks[id]._id %>" name="park" type="hidden">
                    <button type="submit">Delete Review</button>
                </form>

            <% } %>
            <hr>
        <% } %>
</body>
</html>